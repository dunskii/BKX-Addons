/**
 * Security & Audit - Admin Styles
 *
 * @package BookingX\SecurityAudit
 */

/* Layout */
.bkx-security-admin {
	max-width: 1400px;
}

.bkx-security-content {
	margin-top: 20px;
}

.bkx-security-row {
	display: flex;
	gap: 20px;
	margin-bottom: 20px;
}

.bkx-security-half {
	flex: 1;
}

/* Cards */
.bkx-security-card {
	background: #fff;
	border: 1px solid #ccd0d4;
	border-radius: 4px;
	padding: 20px;
	margin-bottom: 20px;
	box-shadow: 0 1px 1px rgba(0, 0, 0, 0.04);
}

.bkx-security-card h2 {
	margin-top: 0;
	margin-bottom: 15px;
	padding-bottom: 10px;
	border-bottom: 1px solid #eee;
}

.bkx-security-card-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 15px;
	padding-bottom: 10px;
	border-bottom: 1px solid #eee;
}

.bkx-security-card-header h2 {
	margin: 0;
	border: none;
	padding: 0;
}

/* Stats Row */
.bkx-security-stats-row {
	display: flex;
	gap: 20px;
	margin-bottom: 20px;
}

.bkx-security-stat-card {
	flex: 1;
	background: #fff;
	border: 1px solid #ccd0d4;
	border-radius: 4px;
	padding: 20px;
	text-align: center;
}

.bkx-security-stat-card.bkx-stat-warning {
	border-color: #dba617;
	background: #fff8e5;
}

.bkx-security-stat-value {
	display: block;
	font-size: 2.5em;
	font-weight: 600;
	line-height: 1.2;
}

.bkx-security-stat-value.bkx-stat-ok {
	color: #46b450;
}

.bkx-security-stat-label {
	display: block;
	color: #646970;
	font-size: 13px;
	margin-top: 5px;
}

.bkx-security-stat-date,
.bkx-security-stat-link {
	display: block;
	margin-top: 10px;
	font-size: 12px;
}

/* Quick Actions */
.bkx-security-quick-actions {
	display: flex;
	flex-wrap: wrap;
	gap: 10px;
}

.bkx-security-quick-actions .button .dashicons {
	margin-right: 5px;
	vertical-align: middle;
	margin-top: -2px;
}

/* Checklist */
.bkx-security-checklist {
	list-style: none;
	padding: 0;
	margin: 0;
}

.bkx-security-checklist li {
	padding: 8px 0 8px 28px;
	position: relative;
	border-bottom: 1px solid #f0f0f0;
}

.bkx-security-checklist li:last-child {
	border-bottom: none;
}

.bkx-security-checklist li::before {
	content: "";
	position: absolute;
	left: 0;
	top: 50%;
	transform: translateY(-50%);
	width: 18px;
	height: 18px;
	border-radius: 50%;
}

.bkx-security-checklist li.complete::before {
	background: #46b450;
	content: "\2713";
	color: #fff;
	font-size: 12px;
	line-height: 18px;
	text-align: center;
}

.bkx-security-checklist li.incomplete::before {
	background: #ccc;
}

/* Issues List */
.bkx-security-issues-list,
.bkx-issues-list,
.bkx-warnings-list {
	list-style: none;
	padding: 0;
	margin: 0;
}

.bkx-security-issue,
.bkx-issue,
.bkx-warning {
	display: flex;
	gap: 15px;
	padding: 15px;
	margin-bottom: 10px;
	border-radius: 4px;
	background: #f9f9f9;
}

.bkx-security-issue.bkx-severity-critical,
.bkx-issue.bkx-severity-critical {
	background: #fbeaea;
	border-left: 4px solid #dc3232;
}

.bkx-security-issue.bkx-severity-high,
.bkx-issue.bkx-severity-high {
	background: #fcf0e5;
	border-left: 4px solid #f56e28;
}

.bkx-security-issue.bkx-severity-medium,
.bkx-issue.bkx-severity-medium {
	background: #fff8e5;
	border-left: 4px solid #dba617;
}

.bkx-security-issue.bkx-severity-low,
.bkx-issue.bkx-severity-low {
	background: #e7f3ff;
	border-left: 4px solid #0073aa;
}

.bkx-warning {
	background: #fff8e5;
	border-left: 4px solid #dba617;
}

.bkx-warning .dashicons {
	color: #dba617;
}

.bkx-security-issue-badge,
.bkx-issue-badge {
	flex-shrink: 0;
	padding: 3px 8px;
	border-radius: 3px;
	font-size: 11px;
	font-weight: 600;
	text-transform: uppercase;
	background: #dc3232;
	color: #fff;
}

.bkx-severity-high .bkx-issue-badge { background: #f56e28; }
.bkx-severity-medium .bkx-issue-badge { background: #dba617; }
.bkx-severity-low .bkx-issue-badge { background: #0073aa; }

.bkx-security-issue-content p,
.bkx-issue-content p {
	margin: 5px 0 0;
	color: #666;
	font-size: 13px;
}

/* Action Badges */
.bkx-action-badge {
	display: inline-block;
	padding: 2px 8px;
	border-radius: 3px;
	font-size: 11px;
	background: #eee;
	color: #333;
}

.bkx-action-user-login,
.bkx-action-user-logout { background: #d4edda; color: #155724; }
.bkx-action-login-failed { background: #f8d7da; color: #721c24; }
.bkx-action-booking-created { background: #cce5ff; color: #004085; }
.bkx-action-booking-updated,
.bkx-action-booking-status-changed { background: #fff3cd; color: #856404; }
.bkx-action-booking-deleted,
.bkx-action-user-deleted { background: #f8d7da; color: #721c24; }

/* Status Badges */
.bkx-status {
	display: inline-block;
	padding: 3px 8px;
	border-radius: 3px;
	font-size: 11px;
	font-weight: 500;
}

.bkx-status-active,
.bkx-status-pending { background: #fff3cd; color: #856404; }
.bkx-status-resolved,
.bkx-status-cleared { background: #d4edda; color: #155724; }
.bkx-status-expired { background: #e9ecef; color: #6c757d; }

/* Severity Badges */
.bkx-severity-badge {
	display: inline-block;
	padding: 3px 8px;
	border-radius: 3px;
	font-size: 11px;
	font-weight: 600;
	text-transform: uppercase;
	color: #fff;
}

.bkx-severity-critical { background: #dc3232; }
.bkx-severity-high { background: #f56e28; }
.bkx-severity-medium { background: #dba617; }
.bkx-severity-low { background: #0073aa; }

/* Filters */
.bkx-security-filters {
	margin: 15px 0;
	display: flex;
	flex-wrap: wrap;
	gap: 10px;
	align-items: center;
}

.bkx-security-filters select,
.bkx-security-filters input[type="date"],
.bkx-security-filters input[type="search"] {
	margin-right: 0;
}

/* No Data */
.bkx-security-no-data {
	padding: 40px 20px;
	text-align: center;
	color: #646970;
	background: #f6f7f7;
	border-radius: 4px;
}

.bkx-muted {
	color: #999;
}

.bkx-count-warning {
	color: #dc3232;
	font-weight: 600;
}

/* Modal */
.bkx-security-modal {
	position: fixed;
	z-index: 100000;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
	background: rgba(0, 0, 0, 0.6);
	overflow: auto;
}

.bkx-security-modal-content {
	background: #fff;
	margin: 5% auto;
	padding: 0;
	border-radius: 4px;
	width: 90%;
	max-width: 700px;
	position: relative;
	box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

.bkx-security-modal-content h2 {
	margin: 0;
	padding: 15px 20px;
	background: #f6f7f7;
	border-bottom: 1px solid #ddd;
	border-radius: 4px 4px 0 0;
}

.bkx-security-modal-close {
	position: absolute;
	right: 15px;
	top: 12px;
	font-size: 24px;
	font-weight: bold;
	color: #666;
	cursor: pointer;
}

.bkx-security-modal-close:hover {
	color: #000;
}

.bkx-security-modal pre {
	margin: 20px;
	padding: 15px;
	background: #f9f9f9;
	border: 1px solid #eee;
	border-radius: 4px;
	overflow: auto;
	max-height: 400px;
}

/* Dropdown */
.bkx-security-dropdown {
	position: absolute;
	background: #fff;
	border: 1px solid #ccd0d4;
	border-radius: 4px;
	box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
	z-index: 1000;
}

.bkx-security-dropdown ul {
	list-style: none;
	margin: 0;
	padding: 5px 0;
}

.bkx-security-dropdown li a {
	display: block;
	padding: 8px 15px;
	color: #333;
	text-decoration: none;
}

.bkx-security-dropdown li a:hover {
	background: #f0f0f0;
}

/* Score Card */
.bkx-score-card {
	display: flex;
	gap: 30px;
	align-items: center;
}

.bkx-score-circle {
	width: 120px;
	height: 120px;
	border-radius: 50%;
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	flex-shrink: 0;
}

.bkx-score-good { background: #d4edda; border: 4px solid #46b450; }
.bkx-score-warning { background: #fff3cd; border: 4px solid #dba617; }
.bkx-score-bad { background: #f8d7da; border: 4px solid #dc3232; }

.bkx-score-value {
	font-size: 2.5em;
	font-weight: 700;
	line-height: 1;
}

.bkx-score-good .bkx-score-value { color: #46b450; }
.bkx-score-warning .bkx-score-value { color: #dba617; }
.bkx-score-bad .bkx-score-value { color: #dc3232; }

.bkx-score-label {
	font-size: 12px;
	color: #666;
	text-transform: uppercase;
}

.bkx-score-summary {
	flex: 1;
}

.bkx-score-summary ul {
	margin: 10px 0 0;
	padding: 0;
	list-style: none;
	display: flex;
	gap: 20px;
}

.bkx-score-summary li {
	padding: 5px 10px;
	background: #f0f0f0;
	border-radius: 3px;
	font-size: 13px;
}

/* Scanner */
.bkx-scanner-action {
	text-align: center;
	margin: 30px 0;
}

.bkx-scanner-action .button-hero .dashicons {
	font-size: 24px;
	margin-right: 10px;
	vertical-align: middle;
}

.bkx-last-scan {
	text-align: center;
	color: #666;
	font-size: 13px;
}

.bkx-progress-bar {
	height: 20px;
	background: #eee;
	border-radius: 10px;
	overflow: hidden;
	margin: 20px 0;
}

.bkx-progress-fill {
	height: 100%;
	background: linear-gradient(90deg, #0073aa, #46b450);
	width: 0;
	transition: width 0.5s ease;
	animation: bkx-progress 2s infinite;
}

@keyframes bkx-progress {
	0% { width: 0%; }
	50% { width: 70%; }
	100% { width: 100%; }
}

.bkx-scan-status {
	text-align: center;
	color: #666;
}

.bkx-check-list {
	list-style: none;
	padding: 0;
	margin: 0;
}

.bkx-check-list li {
	padding: 8px 0;
	border-bottom: 1px solid #f0f0f0;
}

.bkx-check-list li:last-child {
	border-bottom: none;
}

.bkx-check-list .dashicons {
	color: #46b450;
	margin-right: 8px;
}

.bkx-no-scan {
	text-align: center;
	padding: 40px 20px;
}

.bkx-no-scan .dashicons {
	font-size: 48px;
	width: 48px;
	height: 48px;
	color: #ccc;
}

/* File Integrity */
.bkx-file-actions {
	display: flex;
	gap: 10px;
	margin-bottom: 20px;
}

.bkx-file-actions .button .dashicons {
	margin-right: 5px;
	vertical-align: middle;
}

.bkx-file-status .bkx-file-modified { color: #dba617; font-weight: 500; }
.bkx-file-status .bkx-file-new { color: #0073aa; font-weight: 500; }
.bkx-file-status .bkx-file-deleted { color: #dc3232; font-weight: 500; }

.bkx-dir-list {
	list-style: none;
	padding: 0;
	margin: 0;
}

.bkx-dir-list li {
	padding: 8px 0;
	border-bottom: 1px solid #f0f0f0;
}

.bkx-dir-list li:last-child {
	border-bottom: none;
}

.bkx-no-baseline {
	text-align: center;
	padding: 30px 20px;
}

.bkx-no-baseline .dashicons {
	font-size: 48px;
	width: 48px;
	height: 48px;
	color: #ccc;
}

.bkx-file-path {
	max-width: 200px;
	display: inline-block;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}

/* Responsive */
@media screen and (max-width: 782px) {
	.bkx-security-stats-row,
	.bkx-security-row {
		flex-direction: column;
	}

	.bkx-security-modal-content {
		width: 95%;
		margin: 2% auto;
	}

	.bkx-score-card {
		flex-direction: column;
		text-align: center;
	}
}
